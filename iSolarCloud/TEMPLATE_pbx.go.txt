package pbx

import (
	"GoSungro/Only"
	"fmt"
)

func (p *SunGro) CountSTRUCTUREs(domain string) error {

	for range Only.Once {
		domain = p.VerifyDomain(domain)

		query, err := p.STRUCTURE.Count(domain)
		if err != nil {
			p.Error = err
			break
		}

		if p.OutputType == TypeHuman {
			_, _ = fmt.Printf("STRUCTUREs: %v\n", query.Response.Total)
			break
		}
		if p.OutputType == TypeJson {
			//_, _ = fmt.Fprintf(os.Stderr, "# Domains ")
			_, _ = fmt.Printf("%s", query.Response.JsonString())
			break
		}
	}

	return p.Error
}

func (p *SunGro) ListSTRUCTUREs(domain string) error {

	for range Only.Once {
		domain = p.VerifyDomain(domain)

		query, err := p.STRUCTURE.List(domain)
		if err != nil {
			p.Error = err
			break
		}

		if p.OutputType == TypeHuman {
			_, _ = fmt.Printf("STRUCTUREs:\n%v\n", query.Response.String())
			break
		}
		if p.OutputType == TypeJson {
			//_, _ = fmt.Fprintf(os.Stderr, "# Domains ")
			_, _ = fmt.Printf("%s", query.Response.JsonString())
			break
		}
		if p.OutputType == TypeGoogle {
			data := query.Response.ToArray()
			p.Error = p.UpdateGoogleSheet("device", data)
			break
		}
	}

	return p.Error
}

func (p *SunGro) ReadSTRUCTUREs(domain string) error {

	for range Only.Once {
		domain = p.VerifyDomain(domain)

		query, err := p.STRUCTURE.Read(domain)
		if err != nil {
			p.Error = err
			break
		}

		if p.OutputType == TypeHuman {
			_, _ = fmt.Printf("STRUCTUREs:\n%v\n", query.Response.String())
			break
		}
		if p.OutputType == TypeJson {
			//_, _ = fmt.Fprintf(os.Stderr, "# Domains ")
			_, _ = fmt.Printf("%s", query.Response.JsonString())
			break
		}
		if p.OutputType == TypeGoogle {
			data := query.Response.ToArray()
			p.Error = p.UpdateGoogleSheet("device", data)
			break
		}
	}

	return p.Error
}

